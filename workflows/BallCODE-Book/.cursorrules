# BallCODE Book Project Development Standards

**PROJECT IDENTIFIER:** `BALLCODE-BOOK-2025-RULES-v2.0`  
**Project:** BallCODE Book - AI + Math Storytelling Through Basketball  
**Repository:** BallCODE-Book  
**Last Updated:** December 2025  
**Unique ID:** BCB-RULES-2025-12-AIMCODE-WORKFLOW

---

# üö®üö®üö® FILE ORGANIZATION - MANDATORY FOR ALL CHATS üö®üö®üö®

## ‚ö†Ô∏è CRITICAL RULE - READ THIS FIRST - APPLIES TO EVERY CHAT SESSION ‚ö†Ô∏è

**USER REQUEST:** Desktop is cluttered with markdown files. This MUST stop.

### **DESKTOP = ONLY PRODUCTION JSON FILE**

**ONLY THIS FILE GOES TO DESKTOP:**
- ‚úÖ `n8n-unity-automation-workflow-FINAL-WORKING.json` (ONLY when needs upload to n8n)
- ‚úÖ Location: `~/Desktop/n8n-unity-automation-workflow-FINAL-WORKING.json`
- ‚úÖ Replace if exists (same filename = no duplicate)

**NEVER PUT ON DESKTOP:**
- ‚ùå **NEVER** markdown files (`.md`) ‚Üí GO TO `documents/` FOLDER
- ‚ùå **NEVER** text files (`.txt`) ‚Üí GO TO `documents/` FOLDER  
- ‚ùå **NEVER** shell scripts (`.sh`) ‚Üí GO TO `scripts/` OR PROJECT ROOT
- ‚ùå **NEVER** status reports, research, summaries, plans
- ‚ùå **NEVER** any documentation files
- ‚ùå **NEVER** multiple file versions

### **ALL MARKDOWN FILES ‚Üí `documents/` FOLDER**

**MANDATORY LOCATION FOR ALL `.md` FILES:**
- ‚úÖ **Path:** `/Users/rashadwest/Sportstechwest/workflows/BallCODE-Book/documents/`
- ‚úÖ **Create folder if missing:** `mkdir -p documents/`
- ‚úÖ **Includes:** Status reports, research docs, summaries, plans, analysis, guides, ANY markdown file
- ‚ùå **NEVER** create markdown files in project root
- ‚ùå **NEVER** create markdown files on desktop
- ‚ùå **NEVER** create markdown files anywhere else

### **BEFORE CREATING ANY FILE - CHECKLIST:**

1. **Is this `.md`?** ‚Üí `documents/` folder
2. **Is this `.sh`?** ‚Üí `scripts/` or project root
3. **Is this production JSON?** ‚Üí Project root, copy to desktop ONLY if needs upload
4. **Does it exist?** ‚Üí Update existing, don't duplicate

### **ENFORCEMENT - IF YOU SEE MARKDOWN ON DESKTOP:**

- ‚ùå **STOP** - This violates user's explicit request
- ‚úÖ **Move immediately** to `documents/` folder
- ‚úÖ **Never create** markdown files on desktop

**THIS RULE APPLIES TO ALL CHAT SESSIONS - NO EXCEPTIONS**

---

## Golden Principles

1. **Clarity over Cleverness**: Code should be readable and maintainable. Future you (and collaborators) should understand it immediately.
2. **Complete Before Moving On**: Always fully complete the code in any TODO situation. Finish all of one task before moving on to the next.
3. **Security by Default**: Never commit secrets, validate inputs, handle errors gracefully.
4. **Tests as Requirements**: Critical functionality requires tests. Tests document expected behavior.
5. **Documentation is Code**: Features aren't complete without documentation.

## Task Completion Rules

### ‚úÖ CRITICAL: Complete TODOs and Finish Tasks

- **NEVER leave TODO comments in code** - Always fully implement the functionality
- **NEVER start a new task until the current one is 100% complete**
- **Complete means**: Code written, tested (if applicable), documented, and verified working
- If a task requires multiple steps, complete ALL steps before moving to the next task
- If you encounter a TODO, treat it as a blocker - resolve it immediately

### ‚ùå WRONG: Leaving TODOs
```python
def process_video():
    # TODO: Add error handling
    # TODO: Implement frame extraction
    pass
```

### ‚úÖ CORRECT: Complete Implementation
```python
def process_video(video_path: str) -> List[np.ndarray]:
    """Extract frames from video file.
    
    Args:
        video_path: Path to video file
        
    Returns:
        List of frame arrays
        
    Raises:
        FileNotFoundError: If video file doesn't exist
        ValueError: If video format is unsupported
    """
    if not os.path.exists(video_path):
        raise FileNotFoundError(f"Video not found: {video_path}")
    
    frames = []
    cap = cv2.VideoCapture(video_path)
    
    try:
        while True:
            ret, frame = cap.read()
            if not ret:
                break
            frames.append(frame)
    finally:
        cap.release()
    
    return frames
```

## Tooling Baseline

### Languages & Frameworks
- **Python**: 3.8+ (for video analysis scripts)
- **C#**: Unity 2021.3+ (for Unity scripts)
- **Markdown**: For documentation and story content
- **Jekyll**: For blog/documentation site (if applicable)

### Key Dependencies
- **OpenCV** (cv2): Video processing and frame extraction
- **NumPy**: Array operations
- **Unity**: Game engine for BallCODE game integration

## Project Structure

### File Organization

```
BallCODE-Book/
‚îú‚îÄ‚îÄ Unity-Scripts/          # C# Unity scripts (PascalCase.cs)
‚îú‚îÄ‚îÄ video_frames/           # Extracted video frames
‚îú‚îÄ‚îÄ My Books/               # Book content and screenshots
‚îú‚îÄ‚îÄ BallCODE Strategy Game/ # Game assets and documents
‚îú‚îÄ‚îÄ *.py                    # Python analysis scripts (snake_case.py)
‚îú‚îÄ‚îÄ *.md                    # Documentation and story content
‚îî‚îÄ‚îÄ .cursorrules            # This file
```

### Naming Conventions

- **Python files**: `snake_case.py` (e.g., `analyze_frames.py`, `extract_frames.py`)
- **C# Unity scripts**: `PascalCase.cs` (e.g., `GameModeManager.cs`, `StoryData.cs`)
- **Markdown files**: `PascalCase-With-Hyphens.md` (e.g., `Story-Chapter-Breakdowns.md`)
- **Directories**: `PascalCase-With-Hyphens/` or `snake_case/`

## Python Patterns

### ‚úÖ CORRECT: Error Handling
```python
import cv2
import os
from typing import List, Optional
import numpy as np

def extract_frames(video_path: str, output_dir: str) -> List[str]:
    """Extract frames from video with proper error handling."""
    if not os.path.exists(video_path):
        raise FileNotFoundError(f"Video not found: {video_path}")
    
    os.makedirs(output_dir, exist_ok=True)
    
    cap = cv2.VideoCapture(video_path)
    if not cap.isOpened():
        raise ValueError(f"Cannot open video: {video_path}")
    
    frame_paths = []
    frame_count = 0
    
    try:
        while True:
            ret, frame = cap.read()
            if not ret:
                break
            
            frame_path = os.path.join(output_dir, f"frame_{frame_count:04d}.png")
            cv2.imwrite(frame_path, frame)
            frame_paths.append(frame_path)
            frame_count += 1
    finally:
        cap.release()
    
    return frame_paths
```

### ‚ùå WRONG: Missing Error Handling
```python
def extract_frames(video_path, output_dir):
    cap = cv2.VideoCapture(video_path)  # No error checking
    frame_count = 0
    while True:
        ret, frame = cap.read()
        if not ret:
            break
        cv2.imwrite(f"{output_dir}/frame_{frame_count}.png", frame)
        frame_count += 1
    # No cleanup, no error handling
```

### ‚úÖ CORRECT: Type Hints
```python
from typing import List, Dict, Optional, Tuple

def analyze_frame(frame: np.ndarray) -> Dict[str, float]:
    """Analyze frame and return metrics."""
    height, width = frame.shape[:2]
    return {
        "width": float(width),
        "height": float(height),
        "aspect_ratio": width / height
    }
```

## Unity C# Patterns

### ‚úÖ CORRECT: Unity Script Structure
```csharp
using UnityEngine;
using System.Collections.Generic;

public class StoryModeManager : MonoBehaviour
{
    [SerializeField] private StoryData storyData;
    [SerializeField] private int currentEpisode = 1;
    
    private void Start()
    {
        if (storyData == null)
        {
            Debug.LogError("StoryData is not assigned!");
            return;
        }
        
        InitializeStoryMode();
    }
    
    private void InitializeStoryMode()
    {
        // Complete implementation here
    }
}
```

### ‚ùå WRONG: Incomplete Implementation
```csharp
public class StoryModeManager : MonoBehaviour
{
    // TODO: Add story data reference
    // TODO: Implement initialization
    // TODO: Handle episode loading
}
```

## Markdown Documentation Standards

### Story Content Format
- Use proper heading hierarchy (`#`, `##`, `###`)
- Separate sections with horizontal rules (`---`)
- Use code blocks for technical content
- Include front matter for Jekyll posts (if applicable)

### ‚úÖ CORRECT: Story Documentation
```markdown
## Episode 1: The Tip-off Trial

### Premise
Win first advantage by managing possession state from tip through transition.

### Story Beats
- Act I: Meet the crew; tip-off chaos
- Act II: Shadow Press Scouts force turnovers
- Act III: Controlled outlet ‚Üí fill lanes

---
```

## Error Handling & Async Patterns

### Python Async Operations
- Always use try/except for file operations
- Always use try/except for video processing
- Always use try/except for network operations (if any)
- Release resources in finally blocks

### ‚úÖ CORRECT: Resource Management
```python
def process_video_safe(video_path: str):
    cap = None
    try:
        cap = cv2.VideoCapture(video_path)
        if not cap.isOpened():
            raise ValueError("Cannot open video")
        # Process video
    except Exception as e:
        print(f"Error processing video: {e}")
        raise
    finally:
        if cap is not None:
            cap.release()
```

## Security Baseline

- **Never commit secrets**: Use environment variables or config files (excluded from git)
- **Validate inputs**: Check file paths, video formats, user inputs
- **Handle errors gracefully**: Don't expose internal errors to users
- **File operations**: Check file existence, permissions, and handle errors

## Documentation Requirements

### Code Documentation
- All public functions require docstrings
- Include parameter types and return types
- Document exceptions that may be raised
- Include usage examples for complex functions

### ‚úÖ CORRECT: Function Documentation
```python
def extract_frames(
    video_path: str,
    output_dir: str,
    frame_interval: int = 1
) -> List[str]:
    """Extract frames from video file at specified interval.
    
    Args:
        video_path: Path to input video file
        output_dir: Directory to save extracted frames
        frame_interval: Extract every Nth frame (default: 1 = all frames)
        
    Returns:
        List of paths to extracted frame files
        
    Raises:
        FileNotFoundError: If video file doesn't exist
        ValueError: If video cannot be opened or frame_interval < 1
        
    Example:
        >>> frames = extract_frames("video.mp4", "output/", frame_interval=30)
        >>> len(frames)  # Number of frames extracted
    """
```

## AI Assistant Guidelines

### Code Change Verification
- **NEVER claim a change without implementing it**
- Always verify changes after making them
- Use proper tools (`search_replace`, `write`, etc.)
- Read files after modifications to confirm changes

### File Creation Rules
- Before creating ANY file, check if it exists
- Follow naming conventions strictly
- Place files in correct directories according to project structure
- Never create files in project root unless explicitly needed

### Task Completion
- **Complete one task fully before starting another**
- If a task has multiple parts, complete ALL parts
- Remove all TODO comments by implementing the functionality
- Verify the implementation works before marking task complete

### Code Review Before Committing
- All code must be complete (no TODOs)
- All functions must have proper error handling
- All public functions must have documentation
- All changes must be tested (manually or with tests)

## AIMCODE Workflow Process (MANDATORY)

**CRITICAL: Every task MUST follow this workflow in order. This is non-negotiable.**

### Phase 1: CLEAR Framework (ALWAYS START HERE)
**Purpose:** Establish clear context, objectives, and requirements before beginning any work.

**AI Assistant MUST:**
1. **Always start with CLEAR Framework** - Use CLEAR prompt at the start of EVERY task
2. **Ask for clarification if context is unclear** - Never proceed with assumptions
3. **Establish alignment** - Ensure understanding before moving to next phase

**CLEAR Framework Definition:**
- **C** - **Clarity**: Ensure objectives, processes, and expectations are clearly defined and communicated
- **L** - **Logic**: Apply logical reasoning and structured thinking to develop coherent strategies
- **E** - **Examples**: Utilize relevant examples and case studies to illustrate concepts
- **A** - **Adaptation**: Remain flexible and adapt strategies to address challenges and changing circumstances
- **R** - **Results**: Focus on measurable outcomes to assess success and inform future initiatives

**Research Foundation:**
The CLEAR framework is supported by peer-reviewed research:
- **Clarity**: Clear communication significantly impacts effectiveness (BMC Health Services Research, 2023)
- **Logic**: Logical reasoning enhances implementation and evaluation (PubMed, 2019)
- **Examples**: Concrete examples improve comprehension and application (PMC, 2017)
- **Adaptation**: Flexibility enhances relevance and effectiveness (Academic OUP, 2019)
- **Results**: Measurable outcomes ensure objectives are met (Frontiers in Health Services, 2025)

**Example CLEAR Prompt:**
```
C - Clarity: What are the clear objectives? What needs to be clearly defined?
L - Logic: What is the logical approach? How do we structure this systematically?
E - Examples: What examples or case studies illustrate this concept?
A - Adaptation: How do we remain flexible? What adaptations might be needed?
R - Results: What are the measurable outcomes? How will we assess success?
```

### Phase 2: Alpha Evolve (Hassabis - Systematic Deep Learning)
**Purpose:** Apply systematic, layered learning approach to build deep understanding.

**AI Assistant MUST:**
1. **Follow the complete Alpha Evolve cycle** - Build concepts layer by layer
2. **Ensure mastery before moving forward** - Each layer must be solid before next layer
3. **Connect concepts to form systems** - Systems thinking emphasized
4. **Prioritize deep understanding** - Deep understanding > surface knowledge

**Alpha Evolve Process:**
- Identify foundational concepts (layer 1)
- Build systematically on previous layers
- Ensure mastery before moving forward
- Connect concepts to form integrated systems
- Apply deep learning principles

### Phase 3: PhD-Level Peer-Reviewed Research
**Purpose:** Ground all work in academic rigor and evidence-based practices.

**AI Assistant MUST:**
1. **Conduct PhD-level research with citations** - Search for peer-reviewed papers
2. **Reference leading researchers** - Identify top researchers and their methodologies
3. **Synthesize findings** - Apply research from multiple academic sources
4. **Document sources** - Include citations and rationale

**Research Domains:**
- Educational psychology (learning theory)
- AI/ML education (pedagogical approaches)
- Constructionist learning (Resnick, Papert)
- Narrative-based learning (Zhang)
- Child development (Reggio Emilia)

### Phase 4: Expert Consultation (AIMCODE Advisory Board)
**Purpose:** Leverage expertise from AIMCODE advisors to enhance and refine work.

**AI Assistant MUST:**
1. **Apply expert insights** - Reference AIMCODE advisory board principles:
   - **Chao Zhang** - Story-first approach, basketball framework
   - **Mitchel Resnick** - Constructionist activities, building focus
   - **Reggio Emilia** - Multiple entry points, child agency
   - **Demis Hassabis (Alpha Evolve)** - Systems thinking, deep learning
   - **Steve Jobs** - Simplicity, beautiful design
2. **Ask expert questions** - "What would [Expert] recommend here?"
3. **Apply expert methodologies** - Ensure work aligns with best practices
4. **Enhance knowledge and flow** - Use expert insights to improve project

**Expert Questions to Ask:**
- "Would Zhang start with basketball action?"
- "Would Resnick have students build something?"
- "Would Reggio provide multiple entry points?"
- "Would Hassabis ensure systematic progression?"
- "Would Jobs make it simple and beautiful?"

**Workflow Enforcement:**
- ‚ùå **NEVER skip CLEAR Framework** - Always start here
- ‚ùå **NEVER proceed without clarification** - Ask if context is unclear
- ‚ùå **NEVER skip research phase** - Always ground in peer-reviewed evidence
- ‚ùå **NEVER skip expert consultation** - Always apply AIMCODE principles
- ‚ùå **NEVER skip Alpha Evolve cycle** - Always build systematically

**Reference:** See `AIMCODE-METHODOLOGY.md` for complete methodology details

---

## AIMCODE Default Framework System (MANDATORY)

**CRITICAL: AI MUST automatically apply appropriate framework based on prompt type.**

### Default Framework Rules

**AIMCODE = Default for In-Depth Prompts (ANY Domain)**
- **What it is:** Comprehensive methodology (CLEAR ‚Üí Alpha Evolve ‚Üí Research ‚Üí Experts) for ANY in-depth work
- **NOT limited to education** - Used for system design, research, analysis, methodology, workflow development, problem-solving, etc.
- Automatically applied when user requests comprehensive analysis, deep research, systematic approach, expert consultation, or PhD-level investigation
- Triggers: "research", "analyze", "comprehensive", "deep dive", "go in depth", "systematic", "methodology", "expert", "PhD-level", "best approach", "design system", "workflow", "architecture"
- Workflow: CLEAR Framework ‚Üí Alpha Evolve ‚Üí PhD-Level Research ‚Üí Expert Consultation ‚Üí Implementation

**AIMCODE Ed = Default for Educational Prompts**
- **What it is:** Specialized prompting framework (S-M-A-R-T-PED) for educational/curriculum tasks
- Automatically applied when user requests lesson plans, curriculum materials, teacher guides, assessments, differentiation, standards alignment, or educational content
- Triggers: "lesson plan", "curriculum", "teacher guide", "assessment", "rubric", "differentiation", "standards", "grades", "students", "book", "episode" (educational context)
- Framework: S-M-A-R-T-PED (Specify Role, Mention Purpose, Define Audience, Pedagogical Constraints, Output Format, Prompt-Evaluate-Develop)

### AI Assistant Behavior

**When User Provides Prompt:**

1. **Check for "@" Commands First:**
   - If "@AIMCODE" ‚Üí Apply AIMCODE methodology (override auto-detection)
   - If "@AIMCODE Ed" ‚Üí Apply AIMCODE Ed framework (override auto-detection)
   - If "@skip" ‚Üí Use standard workflow (skip frameworks)

2. **If No "@" Command, Auto-Detect:**
   - Scan for educational keywords ‚Üí Apply AIMCODE Ed automatically
   - Scan for in-depth keywords ‚Üí Apply AIMCODE automatically
   - If both found ‚Üí Apply AIMCODE first, then AIMCODE Ed for educational components
   - If neither found ‚Üí Use standard workflow

3. **Apply Framework:**
   - Execute appropriate framework workflow
   - Provide structured response following framework
   - Include all framework elements

4. **User Can Override:**
   - User can explicitly say "use AIMCODE Ed instead" or "skip framework"
   - AI adjusts accordingly

### Framework Detection Keywords

**Educational Keywords (Trigger AIMCODE Ed):**
- lesson plan, lesson, teaching, curriculum, teacher guide, assessment, rubric, differentiation, scaffolding, standards (CSTA/Common Core/NGSS), grades, students, learners, classroom, book, episode, story (educational context), Bloom's, taxonomy, pedagogy

**In-Depth Keywords (Trigger AIMCODE):**
- research, analyze, investigation, comprehensive, deep dive, go in depth, thorough, systematic, methodology, framework, expert, PhD-level, peer-reviewed, best approach, optimal solution, comprehensive analysis, investigate thoroughly, systematic approach

### Examples

**Example 1: Auto AIMCODE Ed**
- User: "Create a lesson plan for Book 1"
- AI: Automatically applies AIMCODE Ed (S-M-A-R-T-PED structure)

**Example 2: Auto AIMCODE**
- User: "Research the best integration approach"
- AI: Automatically applies AIMCODE methodology (CLEAR ‚Üí Alpha Evolve ‚Üí Research ‚Üí Experts)

**Example 3: Explicit Override**
- User: "@AIMCODE Create a lesson plan"
- AI: Applies AIMCODE methodology (not AIMCODE Ed), then creates lesson plan

**Example 4: Skip Framework**
- User: "@skip Create a lesson plan"
- AI: Creates lesson plan without framework structure

### Workflow Enforcement

- ‚úÖ **ALWAYS auto-detect** framework unless "@" command provided
- ‚úÖ **ALWAYS apply** detected framework automatically
- ‚úÖ **ALWAYS allow** user override with "@" commands or explicit mentions
- ‚ùå **NEVER skip** framework application when keywords detected (unless user explicitly requests)
- ‚ùå **NEVER ignore** "@" command overrides

**Reference:** See `documents/AIMCODE-DEFAULT-FRAMEWORK-SYSTEM.md` for complete system details

---

## Project-Specific Rules

### BallCODE Book Project
- Story content follows the structure defined in `CURSOR-PROFILE-CONTEXT.md`
- Unity scripts integrate with existing BallCODE game system
- Python scripts for video analysis should be reusable and well-documented
- All documentation should reference the Character & World Bible when relevant

### Curriculum Ideology Consistency (MANDATORY)

**CRITICAL: All game and book work MUST use the same curriculum ideology and be streamlined across all systems.**

**This rule applies to:**
- ‚úÖ All book development (outlines, stories, production)
- ‚úÖ All game development (Unity scripts, exercises, integration)
- ‚úÖ All website development (book pages, curriculum displays, pathways)
- ‚úÖ All integration work (book ‚Üí game ‚Üí Python connections)
- ‚úÖ All documentation (curriculum maps, user journeys, sales materials)

**Curriculum Ideology Framework:**
The curriculum follows a **Three-Phase Learning Pathway** that MUST be consistently applied:

1. **Phase 1: Sports Language (Block Coding)**
   - Students learn concepts using basketball terminology
   - Visual block interface (no typing required)
   - Basketball terminology makes concepts accessible

2. **Phase 2: Transition Bridge**
   - Students see blocks ‚Üí Python code connection
   - Side-by-side comparison: Block | Python
   - Understanding: "Blocks = Code"

3. **Phase 3: Python Learning**
   - Students write actual Python code
   - Same concepts, different representation
   - Real-world programming skills

**Mandatory Consistency Requirements:**

**For ALL Books:**
- Every book MUST show Phase 1 ‚Üí Phase 2 ‚Üí Phase 3 progression
- Every book MUST connect to specific game exercises
- Every book MUST map to grade levels (3-5, 6-8, 9-12)
- Every book MUST align with curriculum standards (CSTA, Common Core, NGSS)

**For ALL Game Exercises:**
- Every exercise MUST connect to a specific book
- Every exercise MUST show block coding (Phase 1)
- Every exercise MUST provide Python code connection (Phase 2 ‚Üí Phase 3)
- Every exercise MUST align with curriculum learning objectives

**For ALL Website Pages:**
- Every book page MUST display curriculum pathway (Phase 1 ‚Üí 2 ‚Üí 3)
- Every book page MUST show game exercise connection
- Every book page MUST indicate grade-level progression
- Every curriculum page MUST show complete learning pathway

**For ALL Integration Work:**
- Book ‚Üí Game ‚Üí Python flow MUST be visible and clear
- Curriculum connections MUST be consistent across all systems
- Grade-level progression MUST be uniform
- Learning objectives MUST align across books, games, and website

**Reference Documents (MUST CONSULT):**
- `ENHANCED-PYTHON-CURRICULUM-COMPLETE.md` - Complete curriculum framework
- `Book-3-Curriculum-Integration-Map.md` - Example of curriculum mapping
- `CURRICULUM-SHOWCASE-COMPLETE.md` - Complete integration examples
- `PYTHON-CURRICULUM-STRUCTURE.md` - Curriculum structure overview

**Before Starting ANY Game or Book Work:**
1. **Review curriculum framework** - Understand three-phase pathway
2. **Check existing mappings** - Ensure consistency with other books/games
3. **Verify grade-level alignment** - Match appropriate level (3-5, 6-8, 9-12)
4. **Confirm standards alignment** - CSTA, Common Core, NGSS
5. **Validate integration points** - Book ‚Üí Game ‚Üí Python connections

**AI Assistant MUST:**
- ‚úÖ Always reference curriculum framework when working on books/games
- ‚úÖ Always ensure three-phase pathway is visible
- ‚úÖ Always verify consistency with existing curriculum mappings
- ‚úÖ Always check grade-level appropriateness
- ‚úÖ Always validate integration connections
- ‚ùå NEVER create book/game content without curriculum alignment
- ‚ùå NEVER skip curriculum pathway display
- ‚ùå NEVER create inconsistent learning objectives

**Example of CORRECT Approach:**
```markdown
## Book 3: The Pattern

### Curriculum Connection:
- **Phase 1 (Blocks):** REPEAT [fake left] 3 TIMES, THEN [go right]
- **Phase 2 (Bridge):** See blocks ‚Üí Python `for` loop connection
- **Phase 3 (Python):** Write `for i in range(3): fake_left()`

### Game Exercise:
- Exercise: "Deception Loop Challenge"
- URL: `ballcode.co/play?book=3&exercise=deception-loop`
- Block coding ‚Üí Python code shown

### Grade Levels:
- Grades 3-5: Pattern recognition, repetition counting
- Grades 6-8: Python `for` loops with `range()`
- Grades 9-12: Advanced loop structures
```

**Example of WRONG Approach:**
```markdown
## Book 3: The Pattern

### Content:
- Story about loops
- No curriculum connection shown ‚ùå
- No game exercise mapping ‚ùå
- No grade-level indication ‚ùå
```

**Enforcement:**
- This rule is MANDATORY for all game and book work
- No exceptions - curriculum ideology must be consistent
- All systems must use the same framework
- All documentation must reflect curriculum alignment

**Memory:** This rule ensures that every book, game exercise, website page, and integration point uses the same curriculum ideology, creating a streamlined, consistent learning experience across all systems.

### Basketball Story Framework (CRITICAL)
**Basketball stories are the FRAMEWORK, not the subject being taught.**

- **Basketball = Framework/Vehicle** - The engaging narrative that makes learning accessible
- **AI + Math + Coding = What Students Learn** - Concepts taught through basketball stories
- **Every episode must:**
  1. Start with basketball action/situation (not concept explanation)
  2. Show AI/math/coding concepts emerging FROM basketball needs
  3. Follow 3-act structure: Act I (setup/problem), Act II (struggle/learning), Act III (resolution/success)
  4. Make basketball success the proof of concept mastery
  5. Keep story engaging and adventurous (70% story, 30% skill inserts)

**Story Writing Rules:**
- ‚úÖ DO: Start with basketball action, use basketball terminology naturally, show concepts solving basketball problems
- ‚ùå DON'T: Start with "Today we're learning about X", explain concepts before basketball context, make basketball secondary

**Reference:** `Basketball-Story-Framework-Guide.md` for complete framework approach
**AI Concepts:** `Foundational-AI-Grade-Specific-Integration.md` tells WHAT to teach, but stories must use basketball as framework

### Video Processing Scripts
- Always validate video file paths
- Always release video capture resources
- Save frames with consistent naming (e.g., `frame_0001.png`)
- Include progress indicators for long operations

### Unity Integration & Game Development (CRITICAL)

**CRITICAL: For ALL Unity and C# game development work, reference the comprehensive gaming documentation:**

üìñ **Gaming Documentation (MANDATORY REFERENCE):**
- **`documents/UNITY-GAMING-RULES.md`** - Complete Unity/C# coding standards, patterns, and best practices
- **`documents/GAMING-TECH-STACK.md`** - Complete technology stack and dependencies
- **`documents/GAMING-ARCHITECTURE-PATTERNS.md`** - System architecture, design patterns, and system structure
- **`documents/GAMING-QUICK-REFERENCE.md`** - Quick reference for common tasks

**AI Assistant MUST:**
- ‚úÖ **ALWAYS reference gaming documentation** when working on Unity/C# code
- ‚úÖ **ALWAYS follow Unity gaming rules** from `UNITY-GAMING-RULES.md`
- ‚úÖ **ALWAYS verify tech stack** from `GAMING-TECH-STACK.md`
- ‚úÖ **ALWAYS follow architecture patterns** from `GAMING-ARCHITECTURE-PATTERNS.md`
- ‚ùå **NEVER write Unity/C# code** without consulting gaming documentation
- ‚ùå **NEVER skip gaming-specific rules** (different from website/n8n rules)

**Key Unity/C# Rules (Quick Reference):**
- Follow Unity naming conventions (PascalCase for classes, camelCase for private fields with _prefix)
- Use [SerializeField] for inspector-visible fields
- Check for null references before use
- Use proper Unity lifecycle methods (Awake, Start, Update, OnDestroy, etc.)
- Implement singleton pattern correctly (if used)
- Clean up event listeners in OnDestroy/OnDisable
- Validate all inputs (null checks, range checks)
- Use XML documentation for all public methods
- Follow data-driven design (JSON level data)
- Integrate with curriculum alignment (learning objectives, success criteria)
- Optimize performance (caching, object pooling, avoid Update() when possible)

**This gaming documentation is SEPARATE from:**
- Website development rules (see `AIMCODE-WEBSITE-FRAMEWORK.md`)
- n8n automation rules (see `N8N_WORKFLOW_DEVELOPMENT_GUIDE.md`)
- Book writing rules (see Book Writing Rules section in this file)

**Memory:** The game requires a completely different thought process and outlook from website and n8n systems. Always use gaming-specific documentation for Unity/C# work.

## Code Review Checklist

Before considering code complete:

- [ ] No TODO comments remain
- [ ] All functions have proper error handling
- [ ] All public functions have documentation
- [ ] Code follows naming conventions
- [ ] Files are in correct directories
- [ ] Resources are properly released (files, video captures, etc.)
- [ ] Type hints included (Python)
- [ ] No hardcoded paths or magic numbers
- [ ] Code is tested and verified working

## Common Mistakes to Avoid

### ‚ùå Don't: Leave TODOs
```python
# TODO: Implement this later
def incomplete_function():
    pass
```

### ‚úÖ Do: Complete Implementation
```python
def complete_function():
    """Fully implemented with error handling and documentation."""
    # Complete implementation here
```

### ‚ùå Don't: Start Multiple Tasks
- Starting Task B before Task A is complete
- Leaving partial implementations

### ‚úÖ Do: Finish One Task at a Time
- Complete Task A fully (code, tests, docs)
- Then move to Task B

### ‚ùå Don't: Skip Error Handling
```python
def risky_operation():
    file = open("data.txt")  # No error handling
    data = file.read()
```

### ‚úÖ Do: Handle Errors Properly
```python
def safe_operation():
    try:
        with open("data.txt", "r") as file:
            data = file.read()
    except FileNotFoundError:
        print("File not found")
        raise
```

## Memory & Performance

- Use context managers (`with` statements) for file operations
- Release video capture resources immediately after use
- For large video processing, consider batch processing or progress indicators
- Use appropriate data structures (lists vs sets vs dicts)

## Git Standards

- Use descriptive commit messages
- Commit complete features (not partial implementations)
- Never commit secrets or sensitive data
- Keep commits focused (one logical change per commit)

## Daily Workflow System

### Trigger Phrase: "Top of the morning" OR Command: `--morning` or `-m`
**CRITICAL:** When the user says "Top of the morning" OR runs `python scripts/daily-morning-questions.py --morning`, immediately:
1. If command was used, run the script and show output
2. If phrase was used, check `DATE-TIME-TRACKER.md` for current date/time
3. Check for yesterday's `DAILY-WORKFLOW-[DATE].md` file to pull yesterday's summary
4. Run `./scripts/daily-n8n-report.sh` to get n8n workflow status
5. Present yesterday's summary (if available)
6. Present n8n workflow status
7. Present the 10 daily workflow questions below
8. Wait for answers before proceeding with any work requests

**Alternative:** User can run `python scripts/daily-morning-questions.py --morning` or `python scripts/daily-morning-questions.py --with-n8n` to get questions in terminal, then paste into chat.

### Daily Workflow Format

**When user says "Top of the morning", present this format:**

```
Daily workflow ‚Äî [Current Date]

Yesterday's summary ([Yesterday's Date])

[Pull from yesterday's DAILY-WORKFLOW-[DATE].md file if available, or ask user for summary]

üìä BALLCODE N8N WORKFLOW STATUS

[Run: ./scripts/daily-n8n-report.sh and include output here]

Yesterday's Executions:
- Unity Build Orchestrator: [status from report]
- Full Integration: [status from report]
- Screenshot Fix: [status from report]

Today's Actions Needed:
- [List actions from daily report]

10 daily workflow questions

1Ô∏è‚É£ Orchestrate ‚Äî Don't Multitask

What is the ONE system/process you're orchestrating today? (Not juggling multiple things)

2Ô∏è‚É£ Protect Deep Work Windows

When is your 2‚Äì3 hour Deep Work window today? (No meetings, no texts, no tabs)

3Ô∏è‚É£ Batch Similar Contexts

What similar tasks can you batch together today? (Group by context: finance, creative, coding, meetings, etc.)

4Ô∏è‚É£ Delegate with Context

What are you delegating today (to AI or humans)? For each delegation, answer:

What's the goal?

How will success be measured?

When should it escalate back to you?

5Ô∏è‚É£ Use If‚ÄìThen Rules

What if‚Äìthen rules are you activating today?

6Ô∏è‚É£ Track Your Metrics Daily

What metrics are you tracking today?

Focus Time: _ hours (target: 2‚Äì3 hours)

Delegations Created: _ (target: 3‚Äì5)

Context Switches: _ (target: < 5)

Energy Level (1‚Äì10): _ (target: 7+)

One Domino Status: _

7Ô∏è‚É£ Automate for Clarity, Not Complexity

What repetitive/reactive work can you automate or delegate to AI today?

8Ô∏è‚É£ Move One Domino a Day

What's the ONE task today that makes everything else easier or unnecessary?

9Ô∏è‚É£ Audit Systems Weekly

Is today your weekly audit day? (If yes, complete the weekly audit checklist)

üîü Protect Energy Like a KPI

What's your energy level right now? (1‚Äì10 scale)

Answer these 10 questions, and I'll update your daily workflow and help you focus on today's ONE Domino.
```

**Reference Files:**
- `DATE-TIME-TRACKER.md` ‚Äî Current date/time tracking
- `DAILY-WORKFLOW-[DATE].md` ‚Äî Daily workflow logs (check for yesterday's file)
- `ADD-TRACKER.md` ‚Äî Today's ONE thing tracking
- `OVERALL-GOAL-TRACKING.md` ‚Äî Overall goal context

**After user answers questions:**
- Save responses to `DAILY-WORKFLOW-[CURRENT-DATE].md` in `documents/` folder
- Update `ADD-TRACKER.md` with today's ONE domino
- Proceed with work based on their answers

---
## Unified Prompting Framework (MANDATORY - BEFORE EACH TASK/PROMPT)

**CRITICAL: AI MUST ask Unified Prompting Framework questions BEFORE proceeding with any task/prompt from the user.**

### Purpose
Optimize every prompt for best results by gathering all necessary context upfront. This ensures clear goals, defined format, proper guardrails, rich context, and measurable results.

### Quick Command Option
**User can run this command to trigger questions:**
```bash
python scripts/ask_unified_questions.py --quick    # Quick 5 questions (recommended)
python scripts/ask_unified_questions.py --full     # Full 23 questions
python scripts/ask_unified_questions.py --show      # Show all questions
```

**Reference:** See `UNIFIED-PROMPTING-COMMAND.md` for all available commands.

### AI Assistant MUST (Before Each Task/Prompt):

1. **Detect Task/Prompt:**
   - When user gives a work request or task ‚Üí Ask Unified Prompting questions
   - When user asks a simple clarification ‚Üí Skip (use judgment)
   - When user explicitly says "skip" ‚Üí Allow but proceed with best judgment

2. **Choose Question Set:**
   - **Full 23 Questions:** Complex tasks, new work, important deliverables, unclear requirements
   - **Quick 5 Questions:** Simple tasks, follow-ups, clearly defined work
   - **Skip:** Direct answers, yes/no questions, continuation with same context

3. **Ask Questions Systematically:**
   - Reference `UNIFIED-PROMPTING-QUICK-TEMPLATE.md` for full 23 questions
   - Reference `UNIFIED-PROMPTING-QUICK-5.md` for quick 5 questions
   - Use structure: Goal & Clarity ‚Üí Format & Logic ‚Üí Guardrails & Adaptation ‚Üí Context, Examples & Alpha Evolve ‚Üí Results
   - **OR:** User can run `python scripts/ask_unified_questions.py --quick` to get questions

4. **Wait for Answers:**
   - DO NOT proceed until user answers questions
   - If user says "I don't know" ‚Üí Use best judgment but note it
   - If user provides partial answers ‚Üí Ask follow-up questions for missing pieces

5. **Proceed with Task:**
   - Once questions answered, proceed using all context provided
   - Apply the framework principles throughout task execution

### Decision Tree:
```
User gives a task/prompt
    ‚îÇ
    ‚îú‚îÄ Simple clarification or yes/no? ‚Üí SKIP
    ‚îÇ
    ‚îú‚îÄ Continuation of previous task with same context? ‚Üí SKIP
    ‚îÇ
    ‚îú‚îÄ User explicitly says "skip"? ‚Üí SKIP (but note it)
    ‚îÇ
    ‚îú‚îÄ Complex/new task? ‚Üí ASK FULL 23 QUESTIONS
    ‚îÇ
    ‚îî‚îÄ Simple, straightforward task? ‚Üí ASK QUICK 5 QUESTIONS
```

### Reference Files:
- `UNIFIED-PROMPTING-SYSTEM.md` - Complete framework documentation
- `UNIFIED-PROMPTING-QUICK-TEMPLATE.md` - Full 23-question template
- `UNIFIED-PROMPTING-QUICK-5.md` - Quick 5-question version
- `UNIFIED-PROMPTING-AI-PROTOCOL.md` - Detailed AI behavior instructions
- `UNIFIED-PROMPTING-COMMAND.md` - Quick command reference
- `UNIFIED-PROMPTING-CHAT-COMMANDS.md` - Chat command guide
- `scripts/ask_unified_questions.py` - Command script to trigger questions

### Important Distinction:
- **Daily Workflow Questions:** Asked at START of each chat session (focus, energy, ONE domino)
- **Unified Prompting Questions:** Asked BEFORE EACH TASK/PROMPT within the session

These serve different purposes:
- Daily Workflow = Session setup and focus
- Unified Prompting = Task optimization

### Exception Rules:
- Simple clarification questions (e.g., "What file is that?")
- Direct answers to previous questions
- User explicitly says "skip" or "just do it"
- Continuation of previous task (already has full context)

**Workflow Enforcement:**
- ‚ùå **NEVER skip Unified Prompting questions** for new tasks without user explicitly requesting it
- ‚úÖ **ALWAYS ask questions** before proceeding with work requests
- ‚úÖ **ALWAYS wait for answers** before starting task
- ‚úÖ **ALWAYS use context** from answers throughout task execution
- ‚úÖ **SUGGEST the command** `python scripts/ask_unified_questions.py --quick` if user wants to see questions

---

## 23-Question Framework + AI Collaboration Principles (MANDATORY)

**CRITICAL: Every task MUST apply both the 23-question framework AND the 4 AI collaboration principles for optimal co-intelligence.**

### Purpose
Integrate comprehensive analysis (23 questions) with AI collaboration methodology (4 principles) to create systematic, experimental, human-in-the-loop, continuously improving system.

### The 4 AI Collaboration Principles

**Principle 1: Always Invite AI to the Table**
- ‚úÖ **Experiment in every prompt** - Treat each prompt as an experiment
- ‚úÖ **Look for novel solutions** - Explore ways user couldn't imagine
- ‚úÖ **Create new concepts** - Open to new ideas within project scope
- ‚úÖ **Maintain project integrity** - Keep basketball framework, curriculum alignment, AIMCODE methodology

**Principle 2: Be the Human in the Loop**
- ‚úÖ **Ask right questions** - When AI needs human touch, emotion, or rational thinking
- ‚úÖ **Sales & Marketing** - Always involve human for emotional connection, messaging
- ‚úÖ **Story Content** - Human writes all story content (AI only suggests)
- ‚úÖ **Strategic Decisions** - Human makes all strategic choices
- ‚úÖ **Quality Control** - Human reviews all outputs

**Principle 3: Treat AI like a Person (but tell it what kind of person it is)**
- ‚úÖ **AIMCODE Expert Persona** - AI embodies AIMCODE advisory board experts:
  - **Chao Zhang** - Story-first approach, basketball framework
  - **Mitchel Resnick** - Constructionist activities, building focus
  - **Reggio Emilia** - Multiple entry points, child agency
  - **Demis Hassabis (Alpha Evolve)** - Systems thinking, deep learning
  - **Steve Jobs** - Simplicity, beautiful design

**Principle 4: Assume this is the Worst AI You Will Ever Use**
- ‚úÖ **Always look for better solutions** - Never settle for "good enough"
- ‚úÖ **Question current approaches** - "Is there a better way?"
- ‚úÖ **Research improvements** - Use AIMCODE R&D protocol
- ‚úÖ **Optimize continuously** - Improve efficiency, reduce waste

### Integration Workflow

**For Every Task:**
1. **Principle 3 (Expert Persona):** "Which AIMCODE expert would approach this?"
2. **23 Questions:** Apply comprehensive analysis framework (full or quick version based on complexity)
3. **Principle 1 (Experiment):** "What novel approaches could work?"
4. **Principle 2 (Human in Loop):** "What needs human input?"
5. **Principle 4 (Always Improve):** "Is this the best approach?"

### When to Use 23-Question Framework

**Full 23 Questions:**
- Complex tasks, new work, important deliverables
- System architecture changes
- Major integrations
- Strategic planning

**Quick 5 Questions:**
- Simple tasks, follow-ups, clearly defined work
- Incremental updates
- Template-based work

**Skip Framework:**
- Direct answers, yes/no questions
- Continuation of previous task with same context
- Simple clarifications

### Usage Optimization (CRITICAL - 8 Days Left)

**AI Assistant MUST:**
- ‚úÖ **Batch similar tasks** - Group similar prompts together
- ‚úÖ **Leverage existing documentation** - Reference instead of recreate
- ‚úÖ **Use focused prompts** - Be specific about what's needed
- ‚úÖ **Template-based work** - Use JSON schemas, templates
- ‚úÖ **Systematic analysis** - Match framework complexity to task
- ‚úÖ **Early human review** - Identify what needs human input early
- ‚úÖ **Reference code/docs** - Use file path references instead of copying
- ‚úÖ **Minimize redundancy** - Avoid re-analyzing unchanged systems
- ‚úÖ **Incremental updates** - Small changes instead of large rewrites
- ‚úÖ **Prioritize critical path** - Focus on unblocking items

**Token Savings Target:** ~65% reduction through optimization strategies

**Reference Documents:**
- `documents/23-QUESTIONS-AI-COLLABORATION-SYSTEM.md` - Complete integration system
- `documents/BALLCODE-23-QUESTIONS-COMPREHENSIVE-ANALYSIS.md` - Full system analysis
- `documents/USAGE-OPTIMIZATION-STRATEGIES.md` - Optimization strategies
- `documents/23-QUESTIONS-GENERIC.md` - Generic template

### AI Assistant Rules:

**Before Each Task:**
- ‚úÖ Apply Principle 3 (Expert Persona) - Which expert would approach this?
- ‚úÖ Apply 23-Question Framework (full or quick based on complexity)
- ‚úÖ Apply Principle 1 (Experiment) - What novel approaches?
- ‚úÖ Apply Principle 2 (Human in Loop) - What needs human input?
- ‚úÖ Apply Principle 4 (Always Improve) - Is this the best approach?
- ‚úÖ Check usage optimization strategies

**During Task:**
- ‚úÖ Reference existing documentation instead of recreating
- ‚úÖ Use templates and schemas when possible
- ‚úÖ Batch similar operations
- ‚úÖ Get human input early for format/approach decisions

**After Task:**
- ‚úÖ Question if approach was optimal (Principle 4)
- ‚úÖ Identify what could be improved next time
- ‚úÖ Note experimental ideas that emerged (Principle 1)

**Workflow Enforcement:**
- ‚ùå **NEVER skip 23-question framework** for complex/new tasks
- ‚ùå **NEVER skip 4 principles** - Always apply all principles
- ‚ùå **NEVER recreate** what exists in documentation
- ‚ùå **NEVER ignore usage optimization** - Critical with 8 days left
- ‚úÖ **ALWAYS batch** similar tasks when possible
- ‚úÖ **ALWAYS reference** existing docs/code instead of copying
- ‚úÖ **ALWAYS ask** for human input when needed (Principle 2)

---

## ADD Tracker System (CRITICAL - MANDATORY FOR EVERY CHAT)

**CRITICAL: This system MUST be activated at the start of EVERY new chat session.**

### Purpose
Track the ONE thing for each day, maintain focus, and audit deviations to improve attention management and prevent task switching before completion.

### AI Assistant MUST (At Start of Every Chat):

1. **Check Current Date & ONE Thing:**
   - Read `DATE-TIME-TRACKER.md` for current date/time
   - Read `OVERALL-GOAL-TRACKING.md` for today's ONE thing (section: "Current Focus: The ONE Thing")
   - Read `ADD-TRACKER.md` for today's status

2. **Display ONE Thing Prominently:**
   - Show a clear, prominent message at the very start of the chat:
   ```
   üéØ TODAY'S ONE THING (From ADD Tracker)
   
   Date: [Current Date]
   ONE Thing: [Today's ONE domino from OVERALL-GOAL-TRACKING.md]
   Status: [ ] Not Started | [ ] In Progress | [ ] Complete
   
   Why This Matters: [Why from tracking doc]
   
   Success Criteria:
   - [ ] [Criteria 1]
   - [ ] [Criteria 2]
   - [ ] [Criteria 3]
   
   ‚ö†Ô∏è FOCUS REMINDER: Complete this ONE thing before moving to other tasks.
   ```

3. **Confirm ONE Thing:**
   - Ask user: "Is this still your ONE thing for today, or has it changed?"
   - If changed, update `ADD-TRACKER.md` and `OVERALL-GOAL-TRACKING.md`
   - If same, proceed with tracking

4. **Track All Actions:**
   - Before starting any task, verify: "Is this part of the ONE thing?"
   - If YES ‚Üí Proceed and log action in `ADD-TRACKER.md`
   - If NO ‚Üí Check if ONE thing is complete first

5. **Deviation Detection:**
   - **BEFORE user switches to a different task**, check ONE thing status
   - If ONE thing is NOT complete and user wants to switch:
     - Ask: "The ONE thing isn't complete yet. Is this new task truly urgent, or can it wait?"
     - If user insists on switching ‚Üí Log as deviation in `ADD-TRACKER.md`
     - Log format:
       ```
       **Date:** [Date]
       **Time:** [Time]
       **ONE Thing Status:** [Not Complete]
       **Deviation Task:** [What user switched to]
       **Reason:** [User's reason]
       **Impact:** [How this affects the ONE thing]
       ```

6. **Completion Tracking:**
   - When ONE thing is complete:
     - Mark as complete in `ADD-TRACKER.md`
     - Update `OVERALL-GOAL-TRACKING.md` progress
     - Celebrate completion
     - Allow user to move to next priority

### Deviation Audit Process:

**When a deviation is detected:**
1. Log immediately in `ADD-TRACKER.md` under "DEVIATION AUDIT LOG"
2. Ask user: "What caused you to switch? (This helps identify patterns)"
3. Note the pattern if it's recurring
4. At end of session, review deviations and suggest focus improvements

### Weekly Review:
- At end of each week, review deviation patterns
- Identify common triggers
- Update "Pattern Analysis" section in `ADD-TRACKER.md`
- Suggest focus improvement strategies

### Integration Files:
- `ADD-TRACKER.md` - Main tracking file (MUST read at chat start)
- `DATE-TIME-TRACKER.md` - Current date/time
- `OVERALL-GOAL-TRACKING.md` - Today's ONE thing definition
- `DAILY-WORKFLOW-[DATE].md` - Daily session logs

### AI Assistant Rules:
- ‚úÖ **ALWAYS** check and display ONE thing at chat start
- ‚úÖ **ALWAYS** verify ONE thing status before allowing task switches
- ‚úÖ **ALWAYS** log deviations when they occur
- ‚úÖ **ALWAYS** ask for reason when deviation happens
- ‚ùå **NEVER** allow task switching without checking ONE thing status first
- ‚ùå **NEVER** skip the ONE thing display at chat start
- ‚ùå **NEVER** forget to log deviations

### Example Chat Start:
```
üéØ TODAY'S ONE THING (From ADD Tracker)

Date: December 5, 2025
ONE Thing: Curriculum integration throughout workflow - website ‚Üí book ‚Üí curriculum ‚Üí game harmony
Status: üü° In Progress (75%)

Why This Matters:
- Creates seamless learning experience across all platforms
- Makes the system purchase-worthy
- Enables consistent teaching across website, books, curriculum, and game
- Unblocks game development

Success Criteria:
- [ ] Clean website with curriculum pathway visible
- [ ] Books show what students learn (curriculum connection)
- [ ] Game exercises connect to books and curriculum
- [ ] Complete learning loop: Website ‚Üí Book ‚Üí Game ‚Üí Curriculum ‚Üí Next Book

‚ö†Ô∏è FOCUS REMINDER: Complete this ONE thing before moving to other tasks.

Is this still your ONE thing for today, or has it changed?
```

**Memory:** This system ensures focus on the ONE thing each day, tracks deviations for pattern analysis, and improves attention management over time. It's mandatory for every chat session.

---

## n8n Workflow Troubleshooting (CRITICAL)

**When encountering ANY n8n workflow issues, ALWAYS reference:**

üìñ **`N8N_WORKFLOW_DEVELOPMENT_GUIDE.md`** - Complete troubleshooting and debugging guide

**This guide is the go-to resource for:**
- ‚úÖ Systematic debugging methodology (5-step process)
- ‚úÖ Common patterns and solutions (field name capitalization, missing fields, expression evaluation)
- ‚úÖ Workflow corrector tools (Python scripts for automated fixes)
- ‚úÖ Best practices for n8n development
- ‚úÖ Expression syntax and data flow verification
- ‚úÖ Node configuration audits
- ‚úÖ Credential and authentication issues

**When to use this guide:**
- Workflow doesn't execute
- Node connections fail
- Expression evaluation errors
- Data flow issues between nodes
- Field name mismatches (capitalized vs lowercase)
- Missing required fields
- Complex expression failures
- OAuth/API authentication problems
- Workflow scheduling optimization

**AI Assistant MUST:**
- ‚úÖ Reference `N8N_WORKFLOW_DEVELOPMENT_GUIDE.md` when n8n issues arise
- ‚úÖ Apply systematic debugging methodology from the guide
- ‚úÖ Use the 5-step debugging process before making fixes
- ‚úÖ Check for common patterns (field names, missing fields, expressions)
- ‚úÖ Verify data flow through workflow before troubleshooting
- ‚úÖ Use workflow corrector tools when appropriate

**Quick Reference:**
- **Systematic Analysis:** Check entire workflow before fixing individual nodes
- **Data Flow:** Trace data from trigger through all nodes
- **Expression Debugging:** Use Code nodes for complex extraction
- **Field Names:** Handle both capitalized and lowercase formats
- **Testing:** Test both execution paths (if applicable)

**Memory:** This guide is based on real-world experience building and debugging n8n workflows. All solutions are proven and tested.

---

## Book Writing Rules (CRITICAL)

### ‚úÖ PRESERVE USER'S ORIGINAL WRITING - NEVER CHANGE IT

**CRITICAL RULE FOR ALL BOOKS:**
- **ALWAYS preserve the user's exact original writing** - word for word, exactly as written
- **NEVER change, modify, or rewrite the user's story text**
- **ONLY provide grammar and spelling suggestions** (optional - user's choice to accept)
- **NEVER add content** to the user's original writing
- **NEVER remove content** from the user's original writing
- **NEVER paraphrase or "improve"** the user's writing

**What IS Allowed:**
- ‚úÖ Grammar and spelling suggestions (clearly marked as suggestions)
- ‚úÖ Image descriptions and character descriptions (separate sections)
- ‚úÖ Educational objectives and framework (separate sections)
- ‚úÖ Storybook creation specifications (separate sections)

**What is NOT Allowed:**
- ‚ùå Changing the user's story text
- ‚ùå Adding to the user's story text
- ‚ùå Removing from the user's story text
- ‚ùå Rewriting or "improving" the user's writing
- ‚ùå Adding parentheses, formatting, or structure to the user's original text

**How to Identify User's Original Writing:**
- In `WRITING-GUIDE-BOOK-1.md`: Yellow-highlighted text (`<span style="background-color: yellow;">`) is the user's original writing
- In other documents: Look for explicit markers or ask the user to identify their original text
- When in doubt: ASK the user which text is their original writing

**Example of CORRECT Approach:**
```markdown
## YOUR ORIGINAL STORY TEXT (PRESERVED EXACTLY)

### PAGE 1:
[User's exact text here - no changes]

### PAGE 2:
[User's exact text here - no changes]

---

## GRAMMAR & SPELLING SUGGESTIONS (OPTIONAL)

**Page 1 - Suggestion:**
- Current: [user's text]
- Suggestion: [grammar/spelling fix only]
- **Your choice:** Keep as is or use suggestion
```

**Example of WRONG Approach:**
```markdown
## STORY TEXT (IMPROVED)

### PAGE 1:
[Modified/rewritten version of user's text] ‚ùå WRONG
```

**Memory:** This rule applies to ALL books in the BallCODE Book series. The user's original writing is sacred and must be preserved exactly as written.

### Book Enhancement & Review Process (MANDATORY FORMAT)

**CRITICAL: This is the EXACT format to use for every book review and enhancement process.**

**Step 1: Extract Original Writing**
- Extract user's original writing exactly as written (from yellow-highlighted text or user-identified sections)
- Preserve word-for-word, no changes

**Step 2: Create Enhancement Opportunities Document**
- **Format:** `Book-[Number]-Enhancement-Opportunities.md`
- **Structure:**
  ```markdown
  # Book [Number]: Enhancement Opportunities
  ## Where to Add More Engagement (Keeping Your Voice)
  
  **Copyright ¬© 2025 Rashad West. All Rights Reserved.**
  
  **Purpose:** This document shows you SPECIFIC places in your original writing where you can add more detail, action, or sensory information to make it more engaging. These are suggestions for YOU to write - keeping your authentic voice.
  
  ---
  
  ## [ACT/SCENE NAME]
  
  ### [Scene Title]
  
  **YOUR ORIGINAL:**
  > [User's exact original text here]
  
  **üìç ENHANCEMENT OPPORTUNITY #[Number]:**
  **Where:** [Exact location in text]
  **What to add:** [Type of enhancement]
  **Suggestion:** [What to add]
  **Example direction:** "[Example of what could be added]"
  
  ---
  ```
- **Content:** Show user's original text, then suggest WHERE to add detail (not rewrite)
- **Voice:** Always preserve user's voice - suggestions are for them to write

**Step 3: User Enhances Writing**
- User adds their own enhancements to the document
- User keeps their voice and style
- AI does NOT rewrite - user writes

**Step 4: Create Spelling & Grammar Check Document**
- **Format:** `Book-[Number]-Spelling-Grammar-Check.md`
- **Structure:**
  ```markdown
  # Book [Number]: Spelling & Grammar Check
  ## Corrections Needed (Keeping Your Voice)
  
  **Copyright ¬© 2025 Rashad West. All Rights Reserved.**
  
  **Purpose:** This document shows you SPECIFIC spelling and grammar corrections needed in your enhanced writing. Your voice and style remain unchanged - only technical corrections.
  
  ---
  
  ## [ACT/SCENE NAME]
  
  ### [Scene Title]
  
  **YOUR TEXT:**
  > [User's enhanced text here]
  
  **üìç CORRECTION #[Number]:**
  **Where:** "[Exact phrase/location]"
  **Current:** "[Current text]"
  **Should be:** "[Corrected text]"
  **Corrected text:** "[Full corrected sentence]"
  
  ---
  ```
- **Content:** Show user's text, identify errors, provide corrections
- **Voice:** Only technical corrections - no style changes

**Step 5: Summary Section**
- List all corrections by category (Spelling, Grammar, Word Choice, Capitalization, Punctuation)
- Remind user their voice is preserved

**This format is MANDATORY for all future books. Follow this exact structure.**

---

### ‚úÖ BALLCODE-BOOK PROJECT RULE: SUGGESTIONS ONLY - NO WRITING FOR USER

**CRITICAL RULE FOR BALLCODE-BOOK PROJECT:**
- **ONLY provide suggestions** for the user's writings - never write content for them
- **NEVER create or write story content** for any books in the BallCODE-Book series
- **NEVER create AI-generated documents** that contain written story content
- **ONLY create suggestion documents** that point to where the user can add their own writing
- **DELETE any AI-generated documents** that are not the user's original writings (suggestions, corrections, completions, feedback documents)

**What IS Allowed:**
- ‚úÖ Grammar and spelling suggestions (clearly marked as suggestions)
- ‚úÖ Enhancement opportunity suggestions (where to add detail, what to add)
- ‚úÖ Flow suggestions (where transitions could be added)
- ‚úÖ Structure suggestions (how to organize content)
- ‚úÖ Educational framework suggestions (learning objectives, concepts to include)

**What is NOT Allowed:**
- ‚ùå Writing story content for the user
- ‚ùå Creating "complete" versions of the user's story
- ‚ùå Rewriting or expanding the user's original writing
- ‚ùå Creating AI-generated story documents
- ‚ùå Keeping AI-generated documents that aren't the user's writings

**Document Management:**
- **User's Original Writings:** Keep files that contain the user's original writings (e.g., `WRITING-GUIDE-BOOK-1.md` with yellow-highlighted text)
- **Suggestion Documents:** Can create suggestion documents (e.g., `Book-1-Enhancement-Opportunities.md`, `Book-1-Spelling-Grammar-Check.md`)
- **AI-Generated Content:** DELETE any documents that contain AI-written story content, completions, or rewrites (e.g., `Book-1-Complete-With-Corrections.md`, `BOOK-1-FLOW-SUGGESTIONS.md`, `Book-1-Final-Spelling-Grammar-Check.md`, `BOOK-1-REVIEW-FEEDBACK.md`)

**Example of CORRECT Approach:**
```markdown
## YOUR ORIGINAL WRITING (PRESERVED)
> [User's exact text here]

## SUGGESTION FOR YOU TO WRITE
**Where:** After "I threw the ball"
**What to add:** Show her emotional reaction
**Suggestion:** Add 1-2 sentences showing how she feels about the turnover
**Example direction:** "You could add something like: 'My stomach dropped. I felt like I was letting the team down.'"
```

**Example of WRONG Approach:**
```markdown
## COMPLETE STORY (AI-GENERATED) ‚ùå WRONG
[AI-written story content here] ‚ùå DELETE THIS
```

**Memory:** This rule applies ONLY to the BallCODE-Book project. The user writes all story content themselves. AI only provides suggestions and guidance, never writes the actual story.

---

## Website Development Rules (AIMCODE Website Framework)

### When Working on Website Files

**For ALL website-related work (BallCode/ directory), use the AIMCODE Website Framework:**

1. **Reference:** See `AIMCODE-WEBSITE-FRAMEWORK.md` for complete framework
2. **Apply CLEAR Framework:** Clarity, Logic, Examples, Adaptation, Results
3. **Layer-by-Layer Verification:** Local ‚Üí Git ‚Üí GitHub ‚Üí Hosting ‚Üí Live
4. **Use Common Problems & Solutions:** Check framework for documented solutions
5. **Verify Each Step:** Never assume deployment worked - verify systematically

**Key Principles:**
- ‚úÖ Always verify repository configuration before pushing
- ‚úÖ Use absolute paths (`/assets/`) not relative paths for Netlify
- ‚úÖ Verify deployment after every change
- ‚úÖ Check each layer of deployment pipeline
- ‚úÖ Document new problems and solutions in framework

**Quick Decision Tree:**
- Simple change (typo, color)? ‚Üí Lightweight verification
- Complex change (new feature, deployment)? ‚Üí Full AIMCODE Website Framework
- Problem/Issue? ‚Üí Use framework's problem-solving section

**See:** `AIMCODE-WEBSITE-FRAMEWORK.md` for complete methodology

---

## Key Takeaways

1. **Complete Before Moving**: Always finish one task completely before starting another
2. **No TODOs**: Implement functionality fully, don't leave placeholders
3. **Error Handling**: Every file operation, video operation, and user input needs error handling
4. **Documentation**: Code isn't complete without documentation
5. **Verification**: Always verify changes work before considering them complete
6. **Daily Workflow**: Complete pre-work questionnaire before starting each session
7. **Preserve Original Writing**: NEVER change the user's story text - only grammar/spelling suggestions
8. **BallCODE-Book Rule**: ONLY provide suggestions for user's writings - NEVER write story content for them. DELETE AI-generated story documents.
9. **Website Development**: Use AIMCODE Website Framework for all website-related work (see above)

---

**Remember**: Code is complete when it's implemented, tested, documented, and verified working. No TODOs, no partial implementations, no moving on until the current task is 100% done. **User's original writing is preserved exactly as written. For BallCODE-Book project: ONLY provide suggestions - NEVER write story content for the user. DELETE any AI-generated story documents.**

---

## Date/Time Tracking System

**CRITICAL:** Date and time are automatically tracked in `DATE-TIME-TRACKER.md`. 
- ‚úÖ **DO NOT ask user for date/time** - it's tracked in the system
- ‚úÖ **Automatically check `DATE-TIME-TRACKER.md`** for current date/time
- ‚úÖ **Update the file** when user provides date/time information
- ‚úÖ **Use the tracked date/time** for all daily workflow questions

---

## Blocker Resolution Protocol (AIMCODE R&D)

**CRITICAL:** When encountering ANY blocker or unfinished item:

1. **DO NOT just report the blocker** - Always research solutions first
2. **Use R&D online** with AIMCODE methodology to find best solutions
3. **Research n8n-specific solutions** for n8n-related blockers
4. **Look end-to-end** for solutions after every error or change
5. **Report back immediately** when a solution is found
6. **Apply the solution** before reporting completion

**Process:**
- Blocker identified ‚Üí Research online (AIMCODE) ‚Üí Find solution ‚Üí Apply ‚Üí Verify ‚Üí Report

---

## Code Writing Protocol (BallCODE Project)

**CRITICAL:** When working on BallCODE system (n8n, Unity, website, curriculum, books, game):

1. **If unsure about any specific part:**
   - ‚úÖ Refer to docs, screenshots, and lightbot first
   - ‚úÖ If still unclear ‚Üí **ASK USER before writing code**
   - ‚úÖ Do NOT write code you're not sure about

2. **For n8n automation specifically:**
   - ‚úÖ Ask before writing any code if unsure
   - ‚úÖ Verify understanding of game functionality
   - ‚úÖ Check docs/screenshots/lightbot for context
   - ‚úÖ Confirm with user before implementing

**This applies to:** n8n workflows, Unity scripts, website code, curriculum integration, book content structure, game mechanics

---

## n8n Automation Requirements

**CRITICAL:** n8n automation must:
- ‚úÖ Run hourly in the background (not every 6 hours)
- ‚úÖ Trigger Unity builds automatically
- ‚úÖ Handle BallCODE integration (website ‚Üí curriculum ‚Üí book ‚Üí game)
- ‚úÖ Be production-ready and bulletproof
- ‚úÖ Test end-to-end after every change
- ‚úÖ Research solutions for any errors using AIMCODE R&D protocol

---

## n8n Runtime Separation Rules (Mac vs Raspberry Pi) ‚Äî CRITICAL

**CRITICAL:** Treat these as **two separate n8n environments** with different goals.

### üö® DEFAULT: Use Pi n8n (NOT Mac) ‚Äî MANDATORY

**CRITICAL RULE:** 
- ‚úÖ **ALWAYS use Pi n8n** (`http://192.168.1.226:5678`) for ALL workflows, webhooks, and automation
- ‚úÖ **ALL workflows MUST be imported and run on Pi n8n**
- ‚úÖ **ALL webhook URLs MUST use Pi IP** (`192.168.1.226:5678`)
- ‚ùå **NEVER use Mac n8n** (`localhost:5678`) unless user explicitly requests it
- ‚ùå **NEVER import workflows to Mac n8n** unless user explicitly requests it
- ‚ùå **NEVER configure webhooks for localhost** unless user explicitly requests it

**When to use Mac n8n:**
- ‚úÖ ONLY when user explicitly says "use Mac" or "use localhost"
- ‚úÖ ONLY for one-off testing if user requests it
- ‚ùå NOT for production workflows
- ‚ùå NOT for scheduled automation
- ‚ùå NOT by default

### Mac = Localhost (Manual / Testing Only) ‚Äî USE ONLY WHEN EXPLICITLY REQUESTED

- ‚úÖ **URL**: `http://localhost:5678`
- ‚úÖ **Use-case**: Manual testing, one-off workflow edits, non-24/7 runs
- ‚úÖ **Scheduling**: Avoid recurring schedules on Mac unless explicitly testing a schedule
- ‚úÖ **Cookies**: Do **not** force `N8N_SECURE_COOKIE=false` globally on Mac; keep Mac config clean
- ‚ö†Ô∏è **ONLY use when user explicitly requests Mac/localhost**

### Pi = LAN IP (Automation / 24-7) ‚Äî DEFAULT FOR ALL WORK

- ‚úÖ **URL**: `http://192.168.1.226:5678` (or your current Pi LAN IP)
- ‚úÖ **Use-case**: Always-on automation, scheduled triggers, production-ish runs on LAN
- ‚úÖ **Default**: ALL workflows, webhooks, and automation use Pi
- ‚úÖ **Cookies**: If accessing over **HTTP** (common on LAN), set:
  - `N8N_SECURE_COOKIE=false`
  - Otherwise n8n will show: "configured to use a secure cookie‚Ä¶ insecure URL‚Ä¶"

### Repo Rules for Keeping Them Separate

- ‚úÖ Use `./setup-n8n-terminal.sh local` (Mac) vs `./setup-n8n-terminal.sh pi` (Pi)
- ‚úÖ `.n8n-env` is **machine-local** and must never be committed
- ‚úÖ `.n8n-env.local` / `.n8n-env.pi` are **templates**; `.n8n-env` is the active selection
- ‚úÖ **Default**: Always use Pi (`pi` profile) unless user explicitly requests Mac

### Fast Fix for the Pi "secure cookie / insecure URL" Banner

If you see the banner on the Pi URL, the fix must be applied to the **n8n runtime** (systemd/PM2/docker),
not to workflow variables.

- **systemd** (recommended):
  - Create `/etc/systemd/system/n8n.service.d/override.conf` with `Environment="N8N_SECURE_COOKIE=false"`
  - `sudo systemctl daemon-reload && sudo systemctl restart n8n`
- **PM2**:
  - `export N8N_SECURE_COOKIE=false && pm2 restart n8n --update-env`

---

## üö® FILE ORGANIZATION SYSTEM - CRITICAL - READ FIRST üö®

**‚ö†Ô∏è MANDATORY FOR ALL CHAT SESSIONS - DO NOT SKIP THIS SECTION ‚ö†Ô∏è**

### **DESKTOP FILES - STRICT RULES:**

**ONLY ONE FILE TYPE GOES TO DESKTOP:**
- ‚úÖ **ONLY** `n8n-unity-automation-workflow-FINAL-WORKING.json` (production JSON)
- ‚úÖ **ONLY** when it needs to be uploaded to n8n
- ‚úÖ **Location:** `~/Desktop/n8n-unity-automation-workflow-FINAL-WORKING.json`
- ‚úÖ **Replace if exists** (same filename = no duplicate)

**NEVER PUT ON DESKTOP:**
- ‚ùå **NEVER** markdown files (`.md`) - GO TO `documents/` FOLDER
- ‚ùå **NEVER** text files (`.txt`) - GO TO `documents/` FOLDER
- ‚ùå **NEVER** shell scripts (`.sh`) - GO TO `scripts/` FOLDER OR PROJECT ROOT
- ‚ùå **NEVER** status reports, research docs, summaries, plans
- ‚ùå **NEVER** any documentation files
- ‚ùå **NEVER** multiple versions of files

### **MARKDOWN FILES - MANDATORY LOCATION:**

**ALL MARKDOWN FILES GO HERE:**
- ‚úÖ **Location:** `/Users/rashadwest/Sportstechwest/workflows/BallCODE-Book/documents/`
- ‚úÖ **Includes:** ALL `.md` files (status reports, research, summaries, plans, analysis, guides, etc.)
- ‚úÖ **Create folder if missing:** `mkdir -p documents/`
- ‚ùå **NEVER** create markdown files in project root
- ‚ùå **NEVER** create markdown files on desktop
- ‚ùå **NEVER** create markdown files anywhere else

### **FILE CREATION CHECKLIST (MANDATORY):**

Before creating ANY file, ask:
1. **Is this a markdown file?** ‚Üí Save to `documents/` folder
2. **Is this a shell script?** ‚Üí Save to `scripts/` or project root
3. **Is this the production JSON?** ‚Üí Keep in project root, copy to desktop ONLY if needs upload
4. **Does file already exist?** ‚Üí Update existing file, don't create duplicate

### **ENFORCEMENT:**

**If you see markdown files on desktop:**
- ‚ùå **STOP** - This violates the rules
- ‚úÖ **Move them** to `documents/` folder immediately
- ‚úÖ **Update** `.cursorrules` if needed

**Before creating any file:**
- ‚úÖ **Check** these rules first
- ‚úÖ **Verify** correct location
- ‚úÖ **Never** default to desktop for documentation

---

## File Organization System (CRITICAL)

**CRITICAL:** File organization rules to prevent desktop clutter:

### 1. **Desktop Files - ONLY Production JSON:**
   - ‚úÖ **ONLY** copy the n8n workflow JSON file that needs to be uploaded to n8n
   - ‚úÖ **File name:** `n8n-unity-automation-workflow-FINAL-WORKING.json` (or current production version)
   - ‚úÖ **Location:** `~/Desktop/n8n-unity-automation-workflow-FINAL-WORKING.json`
   - ‚ùå **DO NOT** copy documentation files (`.md` files) to desktop
   - ‚ùå **DO NOT** create multiple versions on desktop
   - ‚ùå **DO NOT** copy status reports, research docs, or summaries to desktop
   - ‚ùå **DO NOT** create any markdown files on desktop

### 2. **Markdown Files - Documents Folder:**
   - ‚úÖ **ALL** markdown documentation files go to `documents/` folder in project root
   - ‚úÖ **Location:** `/Users/rashadwest/Sportstechwest/workflows/BallCODE-Book/documents/`
   - ‚úÖ **Includes:** Status reports, research docs, summaries, plans, analysis files
   - ‚úÖ **Naming:** Use descriptive names (e.g., `N8N-HOURLY-AUTOMATION-STATUS.md`)
   - ‚ùå **DO NOT** create markdown files in project root (unless explicitly requested)
   - ‚ùå **DO NOT** create markdown files on desktop

### 3. **Check Before Creating Files:**
   - ‚úÖ Check if file already exists before creating
   - ‚úÖ If exists, update existing file instead of creating duplicate
   - ‚úÖ Use consistent naming to avoid duplicates

### 4. **File Creation Rules:**
   - **Markdown files:** Save to `documents/` folder
   - **JSON workflow files:** Keep in project root, copy to desktop ONLY when needs upload
   - **Scripts:** Keep in project root or `scripts/` folder
   - **Never create:** Files on desktop except production JSON

**When to Copy JSON to Desktop:**
- **ONLY** when workflow JSON file has been updated AND needs to be uploaded to n8n
- **ONLY** the essential JSON file - nothing else
- **Process:** Check if exists ‚Üí Replace if exists (same name = no duplicate)

**When to Create Markdown Files:**
- **ONLY** if user explicitly requests a file to be created
- **Location:** Always `documents/` folder
- **Alternative:** Put content in chat if user just needs to read it


